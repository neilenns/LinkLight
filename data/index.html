<!doctype html>
<html class="wa-dark wa-cloak" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>LinkLight</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script
      src="https://kit.webawesome.com/2ef289f478d44f55.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
    <script src="/notyf.js" defer></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css"
    />
    <link rel="stylesheet" href="global.css" />
    <style>
      body {
        max-width: 600px;
      }

      .info-label {
        font-weight: var(--wa-font-weight-semibold);
      }

      .nav-buttons {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 20px;
      }

      .info {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 15px 20px;
      }

      .info-item {
        display: contents;
      }

      /* Constrain badge width to its content to prevent it from filling the grid column */
      .info-item wa-badge {
        width: fit-content;
      }
    </style>
  </head>
  <body>
    <h1>LinkLight</h1>

    <wa-card>
      <div class="info">
        <div class="info-item">
          <span class="info-label">Hostname</span>
          <span id="hostname"></span>
        </div>
        <div class="info-item">
          <span class="info-label">IP address</span>
          <span id="ipAddress"></span>
        </div>
      </div>
    </wa-card>

    <div class="nav-buttons">
      <wa-button href="/config">Configuration</wa-button>
      <wa-button href="/trains">Train status</wa-button>
      <wa-button href="/update">Firmware update</wa-button>
      <wa-button href="/logs">System logs</wa-button>
    </div>
    <script>
      fetch("/api/status")
        .then(function (r) {
          if (!r.ok) throw new Error("HTTP " + r.status);
          return r.json();
        })
        .then(function (data) {
          document.getElementById("hostname").textContent = data.hostname;
          document.getElementById("ipAddress").textContent = data.ipAddress;
        })
        .catch(function (e) {
          notyf.error("Failed to load status");
          console.error("Failed to load status:", e);
        });
    </script>
  </body>
</html>
